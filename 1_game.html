<!DOCTYPE html>

<head>
    <meta charset="UTF-8">
    <title>12-3-1</title>
    <style>
        * {
            margin: 0px;
        }

        p {
            text-align: center;
        }

        #canvas1 {
            border: 1px solid gray;
        }
    </style>
</head>

<body>
    <p>
        <canvas id="canvas1" width="320" height="480"></canvas>
    </p>
    <script>
        const canvas1 = document.getElementById("canvas1");
        const ctx1 = canvas1.getContext("2d");

        //①変数の設定と初期化
        const target = { x: 250, y: 100, dir: 1 };
        const player = { x: 250, y: 400 };
        const ball = { x: -10, y: -10 };
        let point = 0;

        //②一定時間ごとにプログラムgame1を起動させる
        setInterval(game1, 50);

        //③game1関数
        function game1() {
            //画面をクリア
            ctx1.clearRect(0, 0, 320, 480);

            //描画(ゲーゲット)
            ctx1.fillStyle = "black";
            ctx1.fillRect(target.x - 25, target.y - 5, 50, 10);

            //描画(得点)
            ctx1.fillStyle = "black";
            ctx1.font = "20px sans-serif";
            ctx1.fillText(point, target.x, target.y - 5);

            //描画(プレーヤ)
            ctx1.fillStyle = "blue";
            ctx1.fillRect(player.x - 25, player.y - 5, 50, 10);

            //描画(ボール)
            ctx1.fillStyle = "red";
            ctx1.fillRect(ball.x - 5, ball.y - 5, 10, 10);

            //移動計算
            target.x += target.dir;
            ball.y -= 10;

            //壁衝突計算
            if (target.x < 25 || 295 < target.x) {
                target.dir *= -1;
            }

            //得点計算
            if ((ball.y === 100) && (Math.abs(target.x - ball.x) < 25)) {
                point++;
            }
        }

        //④shoot関数
        canvas1.addEventListener("mousedown", function () {
            ball.x = player.x;
            ball.y = player.y;
        });

        //⑤プレーヤコントロール
        canvas1.addEventListener("mousemove", function (e) {
            const rect = e.target.getBoundingClientRect();
            player.x = e.clientX - rect.left;
        });
    </script>
</body>

</html>